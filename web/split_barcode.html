<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>标签拆分</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script src="../js/mui.min.js"></script>
		<script src="../js/api.js"></script>
		<script src="../js/jquery.js"></script>
		<script src="../js/jquery-1.11.1.js"></script>
		<script src="../js/jquery.xml2json.js.js"></script>
		<script src="../js/template-web.js"></script>
		<script src="../js/mui.picker.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/mui.picker.min.css" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="css/common.css" />
		<link rel="stylesheet" type="text/css" href="../css/comment.css" />	
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">标签拆分</h1>
		</header>
		<div class="mui-content">
			<div class="mui-input-group">
				<div class="mui-input-row">
					<label onclick="clicked('commom/saomiao.html','location','web/split_barcode.html');">扫入库位</label>
					<input id="location" placeholder="请扫入库位" type="text" class="mui-input-clear">
				</div>
				<div class="mui-input-row">
					<label onclick="clicked('commom/saomiao.html','barcode','web/split_barcode.html');">扫入条码</label>
					<input id="barcode" placeholder="请扫入条码" type="text" class="mui-input-clear">
				</div>
				<div class="mui-input-row">
					<label onclick="clicked('commom/saomiao.html','count','web/split_barcode.html');">拆分数量</label>
					<input id="loc_num" disabled type="text" class="mui-input-clear" style="background-color: #f3f3f3;">
				</div>
				<div class="mui-content-padded" align="center">
					<button type="button" class="mui-btn mui-btn-success" data-loading-icon="mui-spinner mui-spinner-custom" id="submit_code">确定</button>
					<button type="button" style="margin-top: 0.625rem;" class="mui-btn mui-btn-primary" id="history">历史记录</button>
				</div>
			</div>
		</div>
		<script type="text/javascript">
		window.addEventListener("changeBar", function(e) {
			var inputId = e.detail.inputId
			document.getElementById(inputId).value = e.detail.barcode
		});
		mui.plusReady(function() {
			mask = mui.createMask(function() { //遮罩层callback事件
				if (byId("selectDialog").style.display == "none") {
					return true; //如果没有弹出框，关闭遮罩层
				}
				return false; //返回true,点击关闭mask
			}); /*创建蒙版，保存到mask中*/
		})
		//遮罩层
		function showMask() { /*绑定处理事件*/
			top_value = $(document).scrollTop() //document.documentElement.scrollTop
			document.body.style.overflow = "hidden"
			document.body.style.width = "100%"
			document.body.style.height = "100%"
			document.body.style.position = "fixed"
			mask.show(); /*调用展示遮罩*/
		}
		
		function closeMask() { /*绑定处理事件*/
			document.body.style.overflow = "scroll"
			document.body.style.width = "100%"
			document.body.style.height = "100%"
			document.body.style.position = "relative"
			window.scrollTo(0, top_value); //回到原位置
			mask.close(); /*调用展示属性*/
		}
		
		function clicked(url, f1, urlId) { //扫描触发
			OpenWindow(f1, url, {
				urlId: urlId,
				inputId: f1
			});
		};
		$("#submit_code").click(function() {
			var code = $("#barcode").val();
			var location = $("#location").val();
			var count =$("#count").val();
			var btnArray = ['否', '是'];
			if (code == "" || location == "") {
				mui.alert("请先完善数据")
				return false;
			}
			mui.confirm("是否将【条码：" + code + "】 拆分？", '提示', btnArray, function(e) {
				if (e.index == 1) {
					//mui.alert("正在开发中。。")
					split(code, location,count);
				}
			})
		})
		function split(code, location,count){
			jQueryWeb(" PDA_WMS_BARCODE_SPLIT", {
				"inBinCode": location,
				"inBarcode": code,
				"inQTY":count,
				"userCode": api_localStorageGet("code")
			}, function(xmlHttpRequest, statu) {
				if (statu == 'success') {
					var json_obj = $.xml2json(xmlHttpRequest.responseXML);
					console.log(json_obj)
				}
			})
		}
		</script>
	</body>

</html>
